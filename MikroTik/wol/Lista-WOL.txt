# ---------- LISTA DE COMPUTADORES E MACs ----------
# Adicione ou remova linhas conforme necessário.
# Formato: "NomeDoComputador;XX:XX:XX:XX:XX:XX"
:local computadores {
    "pve-01;c8:ff:bf:04:08:2d";
    "pve-02;c8:ff:bf:04:05:9b";
    "pve-03;00:14:EE:1C:82:A4";
    "Servidor-NAS;00:14:EE:1C:82:A4";
    "PC-Filho;12:34:56:78:90:AB"
}
# ----------------------------------------------------

# Interface de rede onde os computadores estão conectados (geralmente a bridge)
:local interfaceWOL "bridge"

# Esta variável 'wolTarget' será usada para passar o nome do PC para o script
:global wolTarget

# Verifica se a variável foi definida antes de rodar o script
:if ([:len $wolTarget] > 0) do={
    # Procura o MAC correspondente ao nome do PC
    :local macAddress ($computadores->$wolTarget)

    # Se encontrou o MAC, envia o pacote mágico
    :if ([:len $macAddress] > 0) do={
        :log info ("WOL: Enviando pacote para " . $wolTarget . " (" . $macAddress . ")")
        /tool wol interface=$interfaceWOL mac=$macAddress
        :put ("Pacote WOL enviado para " . $wolTarget)
    } else={
        # Se não encontrou, avisa o usuário
        :log error ("WOL: Computador '" . $wolTarget . "' nao encontrado na lista.")
        :put ("Erro: Computador '" . $wolTarget . "' nao encontrado na lista.")
    }
} else={
    # Se o script for executado sem definir o alvo, mostra as opções
    :put "Erro: Especifique o nome do computador para ligar."
    :put "Use o comando: :global wolTarget \"nome-do-pc\"; /system script run Lista-WOL"
    :put " "
    :put "Computadores disponiveis:"
    :foreach nome,mac in=$computadores do={
        :put "  - $nome"
    }
}

# Limpa a variável global para não interferir em execuções futuras
:set wolTarget ""